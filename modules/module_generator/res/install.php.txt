<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');
/**
 * Installation script for
 *
 * @author No-CMS Module Generator
 */
class Install extends CMS_Module_Installer {
    protected $DEPENDENCIES = array();
    protected $NAME = '@namespace';

    //this should be what happen when user install this module
    protected function do_install(){
        $this->remove_all();
        $this->build_all();
    }
    //this should be what happen when user uninstall this module
    protected function do_uninstall(){
        $this->remove_all();
    }
    
    private function remove_all(){
        $module_path = $this->cms_module_path();
    
        // remove navigations
@remove_navigations
        
        // remove parent of all navigations
        $this->remove_navigation("@navigation_parent_name");

        $sql_array = explode('/*split*/',
                file_get_contents(BASEPATH.'../modules/'.
                    $module_path.'/assets/db/uninstall.sql')
            );
        foreach($sql_array as $sql){
            $this->db->query($sql);
        }
    }
    
    private function build_all(){
        $module_path = $this->cms_module_path();
    
        // parent of all navigations
        $this->add_navigation("@navigation_parent_name", "Data ".$module_path, 
            $module_path."/@directory/index", 4);
        
        // add navigations
@add_navigations

        $sql_array = explode('/*split*/',
                file_get_contents(BASEPATH.'../modules/'.
                    $module_path.'/assets/db/install.sql')                
            );
        foreach($sql_array as $sql){
            $this->db->query($sql);
        }
    }
}

?>
